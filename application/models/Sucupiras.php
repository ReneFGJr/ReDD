<?php
class sucupiras extends CI_model
    {
        function process()
            {
                $c = array('3086729','1603661','6599316','6596120','4305734','1604308','6599255','5235196','3097717','4057190','5022568','5022564','5235979','4134748','3084235','4056922','1603186','5242179','1403985','4074775','659499','4942699','6473471','2392787','4905028','2332372','95895','2708484','6599432','3085128','3087389','1603888','1602332','1584449','2082912','6599033','1566016','3998160','4377962','5932549','4216602','5012143','3481364','389750','1551222','6239554','5782194','5323965','7060025','2393135','2663863','3029978','7266616','7618734','6747648','5041227','5041195','91382','3640671','91381','3608880','4853859','6746906','2368178','95787','2722146','2740441','2358137','6087666','5234902','6473896','2740586','675836','366446','2851259','6304794','5714767','4214610','1472802','1329345','5707421','5080378','7134899','2186244','125379','112845','4972354','5007622','188390','2672972','6718941','3087684','1340124','6242126','3723122','6477189','3720010','7619165','2672959','1318423','1041510','91404','6073332','6329927','2712726','893942','375497','3524012','875894','1325139','1340093','665838','119953','656456','3818438','1325169','3726357','4216723','2368235','2712730','7412859','1959885','6308844','7303952','1330559','6462013','6334288','291417','95728','7265913','7670435','2389537','5010208','1338895','95650','2436391','5079395','5290883','7616549','2415952','3100177','1540840','1339177','666007','119954','2201447','2724313','5710742','6339778','152208','5208859','83835','4045067','3219853','2677595','7464249','6792472','4074521','6717318','6747382','1566244','3222075','2358139','2671703','3101975','840447','2573931','2700220','513227','3442878','5946724','6477552','6179893','7059381','6227465','5198287','7624292','3723175','1313826','1541884','6473824','4965095','1854008','7399719','4217424','1701463','6749283','112826','5083194','7189017','1472492','1734994','6655740','2272453','727787','4938249','6479401','5289734','1428722','3370317','1060881','665280','3674248','1551272','2687750','91380','3168025','4074378','4266959','6390990','374392','6747261','472976','95727','5778681','5879317','4977744','5837848','138832','401264','6847952','3640628','419854','666382','1415828','790923','4664946','4266721','5707911','4147493','2658854','3030686','3238259','2774173','5337359','5290790','519874','384386','5599068','5301362','4684597','4972082','3818411','2179212','1149246','483033','2759582','1928696','2313131','3722499','5184163','155898','4373970','2701002','2789777','2356762','5010141','6187554','4469317','664871','5524884','5019547','411336','3639155','6333316','6020486','131414','663354','5290000','3640732','5707798','6319197','6526832','5838447','7432127','2365336','2709851','5079274','6202672','6484291','5328015','5191075','5404401','4952718','4970580','5038196','6236786','7438335','7433943','7619005','4974886','1553679','6821223','5854995','5246664','6320339');
                
                $p = array('Arquivistica','arquivística','Arquivística','Arquivística');
                $d = array('Arquivístico','arquivístico');
                echo '<table>';
                for ($r=0;$r < count($c);$r++)
                    {
                        $sx = $this->process_i($c[$r]).cr();
                        for ($y=0;$y < count($p);$y++)
                            {
                                $tr = '<span style="background-color: yellow">'.UpperCase($p[$y]).'</span>';
                                $sx = troca($sx,$p[$y],$tr);        
                            }
                        for ($y=0;$y < count($d);$y++)
                            {
                                $tr = '<span style="background-color: #a0ffa0;">'.UpperCase($d[$y]).'</span>';
                                $sx = troca($sx,$d[$y],$tr);        
                            }
                         
                        echo $sx;
                    }
                echo '</table>';                    
            }
        function process_I($id='1602332')
            {
                $sx = '<tr><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr>';
                $sx .= '<tr>';
                $sx .= '<td>'.$id.'</td>';
                $txt = file_get_contents('d:/lixo/rita/capes'.$id.'.txt');
                $txt = html_entity_decode($txt);
                
                if (strpos($txt,'id="nome">') == 0)
                    {
                        return($sx . '<td colspan="1" style="color: red;">ERRO DE LEITURA</td><td colspan="1" style="color: red;">ERRO DE LEITURA</td><td colspan="1" style="color: red;">ERRO DE LEITURA</td></tr>');
                    }
                
                $titulo = substr($txt,strpos($txt,'id="nome">')+10,strlen($txt));
                $titulo = substr($titulo,0,strpos($titulo,'</span>'));
                $sx .= '<td>'.$titulo.'</td>';
                
                $resumo = substr($txt,strpos($txt,'id="resumo">')+12,strlen($txt));
                $resumo = substr($resumo,0,strpos($resumo,'</span>'));
                $resumo = troca($resumo,chr(10),'');
                $resumo = troca($resumo,chr(13),'');
                $sx .= '<td>'.$resumo.'</td>';
                
                $keys = substr($txt,strpos($txt,'id="palavras">')+14,strlen($txt));
                $keys = substr($keys,0,strpos($keys,'</span>'));
                $sx .= '<td>'.$keys.'</td>';
                $sx = troca($sx,chr(13),'');
                $sx = troca($sx,chr(10),'');
                return($sx);                
            }
    }
?>
